{% extends 'base.html.twig' %}

{% block title %}Audyt dla {{ data.domain }}{% endblock %}

{% block body %}
<div class="bg-gray-800 pt-3">
    <div class="rounded-tl-3xl bg-gradient-to-r from-blue-900 to-gray-800 p-4 shadow text-2xl text-white">
        <h3 class="font-bold pl-2">Audyt dla domeny: <a href="https://{{data.domain}}">{{ data.domain }}</a></h3>
    </div>
</div>

<div class="bg-gradient-to-b from-indigo-200 to-indigo-100 border-4 border-indigo-500 rounded-lg shadow-xl p-5 m-4">
            <div class="rounded-full p-5 bg-indigo-600 mb-2 text-center"><h3 class="font-bold text-xl md:text-3xl text-white">Dane podstawowe</h3></div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold">Data wykonania audytu:</span> {{data.auditDateTime}}</p>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold">Favicon:</span> {{data.favicon}}</p>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Adres IP serwera:</span> {{data.ipAddress}}</p>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Przekierowanie IP serwera na domenę:</span> 
                {% if data.ipRedirection == true %}
                jest ustawione
                {% else %}
                nie jest ustawione
                {% endif %}</p>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Certyfikat SSL:</span> 
            {% if data.sslCertificate == true %}
                jest
            {% else %}
                brak
            {% endif %}</p>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Przekierowanie na https:</span> 
            {% if data.httpsRedirection == true %}
                jest ustawione
            {% else %}
                nie jest ustawione
            {% endif %}
            </p>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Przekierowanie WWW:</span> 
            {% if data.wwwRedirection == true %}
               <p>  www.{{ data.domain }} => {{ data.domain }}</p> 
            {% else %}
                <p>  {{ data.domain }} => www.{{ data.domain }}</p> 
            {% endif %}
            </p>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Przekierowanie index.html / index.php:</span> 
            {% if data.indexesRedirection.indexPhpStatus == true %}
               <p> {{ data.domain }}/index.php => {{ data.domain }}</p> 
            {% else %}
               <p> {{ data.domain }}/index.php =/> {{ data.domain }}</p> 
            {% endif %}
            {% if data.indexesRedirection.indexHtmlStatus == true %}
               <p> {{ data.domain }}/index.html => {{ data.domain }}</p> 
            {% else %}
                <p> {{ data.domain }}/index.html =/> {{ data.domain }}</p> 
            {% endif %}
            </p>
        </div>
</div>   
<div class="bg-gradient-to-b from-indigo-200 to-indigo-100 border-4 border-indigo-500 rounded-lg shadow-xl p-5 m-4">
<div class="rounded-full p-5 bg-indigo-600 mb-2 text-center"><h3 class="font-bold text-xl md:text-3xl text-white">Przystępność dla robotów</h3></div>    
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Plik robots.txt: </span>
            {% if data.robotsTxt.exists == true %}
                jest
            {% else %}
                brak
            {% endif %}</p>
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Dyrektywa Sitemap: </span> {% if data.robotsTxt.hasSitemapDirective == true %}
                 jest
            {% else %}
                 brak
            {% endif %}</p>
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Meta robots:</span> {{data.robots}}</p>
            </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Plik sitemap.xml: </span>
            {% if data.sitemap == true %}
                jest <a href="https://{{data.domain}}/sitemap.xml" class="underline">link</a>
            {% else %}
                brak
            {% endif %}</p>
        </div>
</div>
    <div class="bg-gradient-to-b from-indigo-200 to-indigo-100 border-4 border-indigo-500 rounded-lg shadow-xl p-5 m-4">
     <div class="rounded-full p-5 bg-indigo-600 mb-2 text-center"><h3 class="font-bold text-xl md:text-3xl text-white">Metadane i treści:</h3></div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Tytuł strony:</span> {{data.title}}</p>
            <p> <span class="font-bold"> Liczba znaków:</span> {{data.title|length}}</p>
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Opis strony:</span> {{data.description}}</p>
            <p> <span class="font-bold"> Liczba znaków:</span> 
            {% if data.description == "brak" %}
                0
            {% else %}
            {{data.description|length}}
            {% endif %}</p>
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Słowa kluczowe:</span> {{data.keywords}}</p>
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Liczba wystąpień nagłówków:</span></p>
            {% if data.headerCounts == false %}
                brak nagłówków na stronie
            {% else %}
            <ul>
                {% for tag, count in data.headerCounts %}
                    <li>{{ tag }}: {{ count }}</li>
                {% endfor %}
            </ul>
            {% endif %}
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
                <p> <span class="font-bold"> Nagłówki unikatowe:</span> {% if data.headersUnique == false  %} nie {% else %} tak {% endif %}</p>
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Wszystkie nagłówki na stronie:</span></p>
            <p> <span class="font-bold"> Liczba wystąpień nagłówków:</span></p>
            {% if data.headers == false %}
                brak nagłówków na stronie
            {% else %}
            <ul>
                {% for header in data.headers %}
                    <li>{{ header.tag }}: {{ header.text }}</li>
                {% endfor %}
            </ul>
            {% endif %}
            </div>
    <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
        <p> <span class="font-bold"> Obrazy bez atrybutu alt:</span></p>
        <ul>
            {% for imageSrc in data.missingAltImages %}
                <li>{{ imageSrc }}</li>
            {% endfor %}
        </ul> 
        </div>
        
    <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
        <p> <span class="font-bold"> Określenie języka strony:</span> {{ data.lang }}</p>
        <p> <span class="font-bold"> Kodowanie strony:</span> {{ data.charset }}</p>
    </div>
    <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
        <p> <span class="font-bold"> RDFa:</span> {{ data.rdfa }}</p>
        <p> <span class="font-bold"> Mikrodane:</span> {{ data.microdata }}</p>
    </div>
    <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
        <p> <span class="font-bold"> Obecność technologii flash:</span> {{data.flash}}</p>
    </div>
    <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
        <p> <span class="font-bold"> Obecność iFrame:</span> {{data.frame}}</p>
    </div>
    <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
        <p> <span class="font-bold"> Inline CSS:</span> {{data.inlineCSS}}</p>
    </div>
</div>
    <div class="bg-gradient-to-b from-indigo-200 to-indigo-100 border-4 border-indigo-500 rounded-lg shadow-xl p-5 m-4">
        
        <div class="rounded-full p-5 bg-indigo-600 mb-2 text-center"><h3 class="font-bold text-3xl text-white">Dane PageSpeed Insights</h3></div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Meta viewport:</span> {{ data.viewport }}</p>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p><span class="font-bold">
            {% if dataPageSpeed.mobile <= 49 %}
                Strona wymaga poprawy na urządzeniach mobilnych.
            {% else %}
                Strona jest użyteczna na urządzeniach mobilnych.
            {% endif %}
            </p></span>
            <p> <span class="font-bold"> Prędkość ładowania mobile:</span> {{ dataPageSpeed.mobile }}</p>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> 
            {% if dataPageSpeed.desktop <= 49 %}
                Strona wymaga poprawy na komputerach stacjonarnych.
            {% else %}
                Strona jest użyteczna na komputerach stacjonarnych.
            {% endif %}
            </p></span>
            <p> <span class="font-bold"> Prędkość ładowania desktop:</span> {{ dataPageSpeed.desktop }}</p>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Core Web Vitals Mobile:</span></p>
                <ul>
                    <li>First Contentful Paint: {{ dataPageSpeed.metrics.mobile.firstContentfulPaint }}</li>
                    <li>Speed Index: {{ dataPageSpeed.metrics.mobile.speedIndex }}</li>
                    <li>Time to Interactive: {{ dataPageSpeed.metrics.mobile.timeToInteractive }}</li>
                    <li>First Meaningful Paint: {{ dataPageSpeed.metrics.mobile.firstMeaningfulPaint }}</li>
                </ul>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Core Web Vitals Desktop:</span></p>
                <ul>
                    <li>First Contentful Paint: {{ dataPageSpeed.metrics.desktop.firstContentfulPaint }}</li>
                    <li>Speed Index: {{ dataPageSpeed.metrics.desktop.speedIndex }}</li>
                    <li>Time to Interactive: {{ dataPageSpeed.metrics.desktop.timeToInteractive }}</li>
                    <li>First Meaningful Paint: {{ dataPageSpeed.metrics.desktop.firstMeaningfulPaint }}</li>
                </ul>
        </div>
        
    </div>
    <div class="bg-gradient-to-b from-indigo-200 to-indigo-100 border-4 border-indigo-500 rounded-lg shadow-xl p-5 m-4">
            <div class="rounded-full p-5 bg-indigo-600 mb-2 text-center"><h3 class="font-bold text-3xl text-white">Linkowanie</h3></div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Lista wewnętrznych linków:</span></p>
            <ul>
                {% for link in data.internalLinks %}
                    <li>{{ link }}</li>
                {% endfor %}
            </ul>
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
                <p> <span class="font-bold"> Najdłuższy url:</span> {{ data.maxLenghtInlinks }} znaków</p>
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
                <p> <span class="font-bold"> Linki przyjazne wyszukiwarce: </span>
                     {% if data.friendlyLinks %}
                        tak
                    {% else %}
                        nie</p>
                        <p> <span class="font-bold"> Lista nieprzyjaznych linków:</span> 
                    <ul>
                        {% for link in data.friendlyLinks %}
                            <li>{{ link }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}</p> 
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
            <p> <span class="font-bold"> Lista linków wychodzących:</span></p>
            {% if data.outLinks == false  %}
                brak linków wychodzących
            {% else %}
            <ul>
                {% for link in data.outLinks %}
                    <li>{{ link.href }} {% if link.rel is not null %} Rel: {{link.rel}} {% endif %}</li>
                {% endfor %} 
            </ul>
            {% endif %}
            </div>
            <div class="mb-4 font-medium md:text-xl break-all border-b-2 border-indigo-500 py-2">
             <p> <span class="font-bold"> Kod Google Analytics:</span> 
             {% if data.googleAnalytics == false  %}
                brak
            {% else %}
                jest
            <ul>
                {% for code in data.googleAnalytics %}
                    <li>{{ code }}</li>
                {% endfor %}
            </ul>
            {% endif %}</p>   
            </div>
        </div>
        <div class="mb-4 font-medium md:text-xl break-all py-2">
            <button id="saveAuditButton" class="bg-indigo-500 hover:bg-indigo-800 text-white font-bold p-4 rounded ml-4">Zapisz audyt</button>
            <div id="saveAuditMessage" style="display: none;"></div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $('#saveAuditButton').click(function () {
            var auditData = {{ data | json_encode | raw }};
            var auditDataPageSpeed = {{ dataPageSpeed | json_encode | raw }};
            var uid = '{{ uid }}';

            $.ajax({
                url: '{{ path('app_save', {'domain': data.domain, 'uid': uid}) }}',
                type: 'POST',
                data: {
                    data: auditData,
                    dataPageSpeed: auditDataPageSpeed
                },
                success: function (response) {
                    $('#saveAuditMessage').text('Pomyślnie zapisano audyt').removeClass('bg-red-500').addClass('bg-green-500 text-white px-4 py-2 mt-4 rounded').show();
                    console.log(response);
                },
                error: function (error) {
                    $('#saveAuditMessage').text('Wystąpił błąd zapisu audytu lub taki audyt jest już zapisany').removeClass('bg-green-500').addClass('bg-red-500 text-white px-4 py-2 mt-4 rounded').show();
                    console.log(error);
                }
            });
        });
    });
</script>
{% endblock %}
